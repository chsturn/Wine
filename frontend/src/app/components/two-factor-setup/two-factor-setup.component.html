<div class="tfa-container">
  <h2>Two-Factor Authentication (2FA)</h2>

  <div *ngIf="success()" class="alert alert-success">{{ success() }}</div>
  <div *ngIf="error()" class="alert alert-danger">{{ error() }}</div>

  <!-- 2FA Setup Flow -->
  <div class="card">
    <h3>Enable 2FA</h3>
    <p>Secure your account with an extra layer of protection.</p>
    <button (click)="startSetup()" *ngIf="!qrCodeUrl()">Enable 2FA</button>

    <div *ngIf="qrCodeUrl()" class="setup-flow">
      <p>1. Scan this QR code with your authenticator app (e.g., Google Authenticator, Authy).</p>
      <img [src]="qrCodeUrl()" alt="2FA QR Code">

      <p>2. Enter the 6-digit code from your app to verify and complete setup.</p>
      <form (ngSubmit)="verifyAndEnable()" class="verify-form">
        <input type="text" [(ngModel)]="verificationToken" name="verificationToken" placeholder="123456" maxlength="6">
        <button type="submit">Verify & Enable</button>
      </form>
    </div>
  </div>

  <!-- 2FA Disable Flow -->
  <div class="card">
    <h3>Disable 2FA</h3>
    <p>If you disable 2FA, your account will only be protected by your password.</p>
    <form (ngSubmit)="disable()" class="disable-form">
      <label for="disablePassword">Enter your password to confirm:</label>
      <input type="password" id="disablePassword" [(ngModel)]="disablePassword" name="disablePassword">
      <button type="submit" class="btn-danger">Disable 2FA</button>
    </form>
  </div>
</div>
